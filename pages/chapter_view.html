<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter Reader | LearnNepal</title>
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/layout.css">
    <link rel="stylesheet" href="../styles/components.css">
    <style>
        .reader-header {
            background: var(--color-bg-alt);
            padding: var(--spacing-xxl) 0;
            text-align: center;
            border-bottom: 1px solid var(--color-border);
        }
        .reader-meta {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            color: var(--color-text-muted);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .reader-content {
            font-family: 'Georgia', serif; /* Optimize for reading */
            font-size: 1.15rem;
            line-height: 1.8;
            max-width: 720px;
            margin: 0 auto;
            padding: var(--spacing-xxl) 0;
            color: var(--color-text-main);
        }
        .reader-content p {
            margin-bottom: 1.5rem;
        }
        .reader-content h2 {
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            font-family: var(--font-heading);
            color: var(--color-primary);
        }
        .chapter-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid var(--color-border);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container header-container">
            <a href="../index.html" class="logo">
                <img src="../assets/images/logo.png" alt="LearnNepal" style="height: 40px; width: auto;">
                LearnNepal<span>.</span>
            </a>

            <button class="mobile-toggle" aria-label="Toggle Navigation">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>

            <nav class="nav-menu">
                <a href="../index.html" class="nav-link">Home</a>
                
                <div class="dropdown">
                    <a href="#" class="nav-link">Class 11</a>
                    <div class="dropdown-menu">
                        <a href="class-11/english.html" class="dropdown-item">English</a>
                        <a href="class-11/nepali.html" class="dropdown-item">Nepali</a>
                        <a href="class-11/computer/c11_computer_syllabus.html" class="dropdown-item">Computer Science</a>
                    </div>
                </div>

                <div class="dropdown">
                    <a href="#" class="nav-link">Class 12</a>
                    <div class="dropdown-menu">
                        <a href="class-12/english/c12_english_syllabus.html" class="dropdown-item">English</a>
                        <a href="class-12/nepali.html" class="dropdown-item">Nepali</a>
                        <a href="class-12/computer/c12_computer_syllabus.html" class="dropdown-item">Computer Science</a>
                    </div>
                </div>

                <a href="../about.html" class="nav-link">About</a>
                <a href="../contact.html" class="btn btn-primary">Contact Us</a>
            </nav>
        </div>
    </header>

    <main id="main-content">
        <div class="reader-header">
            <div class="container">
                <div class="animate-fade-up">
                    <span class="badge" id="chapter-subject">Subject</span>
                    <h1 id="chapter-title" style="margin-top: 0.5rem;">Loading Chapter...</h1>
                    <div class="reader-meta">
                        <span id="chapter-grade">Class 11</span> &bull; 
                        <span id="chapter-genre">Genre</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="container">
                <article class="reader-content animate-fade-up delay-100" id="chapter-body">
                    <p>Loading content...</p>
                </article>

                <div class="chapter-nav">
                    <a href="#" class="btn btn-outline" id="prev-chapter">&larr; Previous</a>
                    <a href="#" class="btn btn-primary" id="next-chapter">Next &rarr;</a>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="#" class="logo"><img src="../assets/images/logo.png" alt="LearnNepal" style="height: 32px; width: auto;"></a>
                    <p>Empowering NEB students with high-quality, structured, and accessible digital notes.</p>
                </div>

                <div class="footer-col">
                    <h4 class="footer-heading">Class 11</h4>
                    <ul class="footer-links">
                        <li><a href="class-11/english.html">English</a></li>
                        <li><a href="class-11/nepali.html">Nepali</a></li>
                        <li><a href="class-11/computer/c11_computer_syllabus.html">Computer Science</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4 class="footer-heading">Class 12</h4>
                    <ul class="footer-links">
                        <li><a href="class-12/english/c12_english_syllabus.html">English</a></li>
                        <li><a href="class-12/nepali.html">Nepali</a></li>
                        <li><a href="class-12/computer/c12_computer_syllabus.html">Computer Science</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4 class="footer-heading">Company</h4>
                    <ul class="footer-links">
                        <li><a href="../about.html">About Us</a></li>
                        <li><a href="../contact.html">Contact</a></li>
                        <li><a href="https://www.youtube.com/@OfficialLearnNepal" target="_blank">YouTube Channel</a></li>
                        <li><a href="../privacy.html">Privacy Policy</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2024 LearnNepal. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Inline script for zero-dependency loading (frontend-only CMS)
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const contentId = params.get('id'); // e.g. "c11_english_unit1"
            const subject = params.get('subject');
            const genre = params.get('genre');
            const title = params.get('title');
            
            // UI References
            const titleEl = document.getElementById('chapter-title');
            const bodyEl = document.getElementById('chapter-body');
            const subjectEl = document.getElementById('chapter-subject');
            const genreEl = document.getElementById('chapter-genre');

            // Set basic info from params if available (instant feedback)
            if (title) titleEl.textContent = decodeURIComponent(title);
            if (subject) subjectEl.textContent = subject.charAt(0).toUpperCase() + subject.slice(1);
            if (genre) genreEl.textContent = decodeURIComponent(genre);

            // Fetch Content Strategy:
            // 1. Try LocalStorage (User/Admin Edits)
            // 2. Try Default JSON
            // 3. Fallback to Placeholder

            const loadContent = () => {
                const lsContent = localStorage.getItem('learnnepal_content');
                let data = lsContent ? JSON.parse(lsContent) : null;

                // If content key exists in our data structure
                if (data && data.chapters && data.chapters[contentId]) {
                    const chapter = data.chapters[contentId];
                    bodyEl.innerHTML = chapter.content || '<p><em>Content coming soon...</em></p>';
                    // Update metadata if stored data is richer
                    if(chapter.title) titleEl.textContent = chapter.title;
                } else {
                    // Placeholder if no content found
                    bodyEl.innerHTML = `
                        <div style="background: var(--color-bg-alt); padding: 2rem; border-radius: 8px; text-align: center;">
                            <p>Content for this chapter is coming soon.</p>
                            <p style="font-size: 0.9rem; color: var(--color-text-muted);">Please check back later.</p>
                        </div>
                    `;
                }
            };

            loadContent();
        });
    </script>
</body>
</html>
